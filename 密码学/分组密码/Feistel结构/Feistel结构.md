
## 为什么要引入分组密码？

先看映射的性质：随位数增长，映射（非线性变换）个数可以呈指数增长。  
$n\text{ bit }\rightarrow 2^n!$ 种变换，$2^n$ 代表了n位数字所有可能，阶乘指全排列，2是二进制bit的底（如果是字母，底为26）

传统密码，分组$n=1$，所以**不抗穷举攻击**。当然传统密码加密的是数字，而不是字母，“分组为1” 指单个字母替换，**不抗一阶统计规律分析**（字母频率）。因此分组过小，不安全。

分组过大，密钥空间会指数膨胀，效率下降很快。因为密钥存储空间为$n\times 2^n$，即存储n个映射。

解决办法就是将一个大分组拆分为数个较小分组，将密钥长度和分组长度解绑。

## Feistel 结构

![|400](../../../attach/Pasted%20image%2020230524160035.png)

对于每次迭代:  
$L_{i+1}=R_{i}$  
$R_{i+1}=F\ (R_{i},\ K_{i})\oplus L_{i}$

解密结构与加密相同, 但需调换 $L,\ R$ 位置:  
$R_{i}=L_{i+1}$  
$L_{i}=F\ (L_{i+1},\ K_{i})\oplus R_{i+1}=F\ (R_{i},\ K_{i})\oplus F\ (R_{i},\ K_{i})\oplus L_{i}$

本质是通过还原 $k=F\ (R_{i},\ K_{i})$, 来还原明文 $k\oplus k\oplus L_{i}=L_{i}$. 在DES实现中, 先调换 $L,\ R$ 顺序, 再进行 $IP^{-1}$ 变换, 同时解密的轮密钥以相反顺序注入.
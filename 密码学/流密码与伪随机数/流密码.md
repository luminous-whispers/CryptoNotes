$c_{i}=m_{i}\oplus k_{i}$, 流密码也称为序列密码, 通过生成*长密钥序列*加密明文, 适用于对数据流进行加密.

其安全性依赖于**密钥流生成器**的不可预测, 设计原则有:
- 长周期
- 高线性复杂度
- 抗统计分析
- 密码安全性, 需: "扩散", "混乱", 抵抗各类攻击

## 1 流密码分类

### 1.1 同步流密码

SSC, Synchronous Stream Cipher. 内部无记忆 (明文寄存器), 且无自同步功能.
![|350](../../attach/Pasted%20image%2020230609220618.png)

### 1.2 自同步流密码

SSSC, Self-Synchronous Stream Cipher, 现常被使用, 如基于LFSR的流密码. 某一时刻密钥流不仅取决于初始密钥, 还取决于前若干明文的线性组合, 强化抗统计分析能力. 有自同步功能 (要产生密钥序列 $z_{i}$, 必须先提供明文序列 $m_{i}$), 但可能有局部错误传播.
![|400](../../attach/Pasted%20image%2020230609220612.png)



## 2 线性反馈移位寄存器序列

如图, 密钥流生成器由**驱动子系统**和**非线性组合子系统**, 驱动子系统生成*统计特性好*的序列, 非线性组合子系统将其变换为*密码特性*好的输出序列. 
![|500](../../attach/Pasted%20image%2020230609221302.png)

常见驱动子系统为LFSR, Linear Feedback Shift Register. 换言之, LFSR是序列密码常用乱源, 用递推关系产生一**周期长, 线性复杂度高, 统计特性好**的乱数序列. LFSR是构造流密码的基础.

LFSR由其反馈逻辑函数定义: $x_{n+1}=f(x_{1},\ x_{2},\ \dots,\ x_{n})=c_{1}x_{n}+c_{2}x_{n-1}+\dots+c_{n}x_{1}$, 实际上是一布尔函数, 其中$c_{i}\in\{0,\ 1\}$, "$+$" 定义为 "$\oplus$". $f$ 决定了 $x_{i}$ 的递推式; 其内部状态 $(x_{n},\ x_{n-1},\dots,x_{n-k})$ 则移位迭代, 左侧接收 $x_{n+1}$, 右侧输出 $x_{n-k-1}$.

![|450](../../attach/Pasted%20image%2020230609234108.png)

类似地, 定义LFSR 的**特征 (级连/生成) 多项式**: $f(x_{1},x_{2},\dots, x_{n})=1+c_{1}x+c_{2}x^{2}+\dots+c_{n}x^{n}$, 该多项式使LFSR可在 $GF(2^{n})$ 上被分析, 其次数代表LFSR的寄存器级数.

例子:
![|500](../../attach/Pasted%20image%2020230609220658.png)

### 2.1 LFSR分析

对于内部状态数为 $n$ 的LFSR, 其能达到的最长周期为 $2^{n}-1$, 周期最长的LFSR序列称为**m序列.** 该逻辑函数 $f$ 的特征多项式, 可以生成**一个周期为$2^{n}-1$的序列和一个全零序列**. 同一序列可能有多个生成 $f$, 但次数最小的称为*极小多项式*, 实质是域 $GF(2^{n})$ 上的一个本原多项式.

从离散数学角度, 该反馈逻辑函数能生成完整*真值表*, 并且其状态转移图是一个圈.

## 3 常见流密码算法

- [RC4算法](RC4流密码算法.md)
DES, Data Encryption Standard, 是1977年颁布的美帝标准加密算法, 源于IBM的Lucifer算法. DES接受56位密钥, 64位明文, 输出64位密文. DES的置换和代换盒的设计标准至今未被公布, 其迭代轮数为何是16也未知, 但其有良好抗差分析性质.

### 1 整体结构

![|500](../../../attach/Pasted%20image%2020230610224500.png)

### 2 密钥扩展

DES密钥长度虽然是56位, 但实现中DES加上了8位校验位, 共64位. `Permuted Choice 1` 在置换同时, 去掉了这8位校验位.

循环左移 `LCS` 操作的*移动比特数*遵循**轮次左移调度表** $\{1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1\}$, 16轮后正好左移 `28bits` 回到初态.

![|500](../../../attach/Pasted%20image%2020230610221457.png)

PC-2盒的置换, 也是分为左右 `28 bits` 进行压缩, 互不相干. 即左 `28 bits` 压缩为 前 `24 bits`, 后 `28bits` 压缩为后 `24 bits`.

DES密钥扩展中仅有置换 `Permuted Choice` 和循环移位 `LCS`, 无非线性运算(如代换), 这导致其存在弱密钥. 例如全零/全一/间或零一, 都是典型弱密钥.

### 3 单轮结构

DES采用单轮[Feistel迭代结构](Feistel结构.md), 共16轮. 加密流程如下:

1. $L_{0}R_{0}\leftarrow IP(m)$
2. $For\ i=1\to 16:$  
	$\quad L_{i}\leftarrow R_{i-1}$  
	$\quad R_{i}\leftarrow L_{i-1}\oplus P(\ S[\ E(R_{i-1})\oplus rk_{i}\ ]\ )$
3. $IP^{-1}(R_{16}L_{16})$

![|350](../../../attach/Pasted%20image%2020230610222849.png)

这个IP有什么用? 为了加解密结构相同还必须在末尾加上逆IP.

#### 3.1 ES变换

扩展盒作用如下, 两侧为新添位, 输出扩展为48位.
```
32 | 01 02 03 04 | 05
04 | 05 06 07 08 | 09
08 | 09 10 11 12 | 13
12 | 13 14 15 16 | 17
16 | 17 18 19 20 | 21
20 | 21 22 23 24 | 25
24 | 25 26 27 28 | 29
28 | 29 30 31 32 | 01
```

DES有8个不同S盒, 每个S盒`6bits`输入, `4bits`输出. 对于输入 $(b_{1}, b_{2}, b_{3}, b_{4},b_{5},b_{6})$, $b_{1}b_{6}$ 确定行, $b_{2}b_{3}b_{4}b_{5}$ 确定列, 得到`4bits`替换输出. 

不难发现, $b_{1}b_{6}$ 就是E盒扩展的部分 (加上轮密钥), E盒和S盒是关系密切的, 合并可省去程序比特切分和组合, [使DES加速](DES-代码加速.md).

***

DES一大缺点是**按比特置换**, 这导致其软件编程麻烦; AES则以字节为单位置换.

> 相关数学知识见 [椭圆曲线](../../../几何/椭圆曲线.md)

## 椭圆曲线密码学 ECC

ECC是建立在基于[**椭圆曲线上的离散对数困难问题**](../../../几何/椭圆曲线.md) 上的密码体制,  
单陷门函数为: $P=[d]G$. 换言之, 给定基点G和公钥P, 求出私钥d是困难的.

> 选择的基点G能够保证满足$[n]G=O$的阶n足够大, 这样能保证有足够多的私钥.  
> 由于公钥算法$P=[d]G$, 选取私钥$d$须满足$1<d<n$, 否则密钥会存在碰撞

### ECC 公钥加密

> 见 [ECC-Elgamal公钥加密](ECC-Elgamal公钥加密.md)

实现基于*Elgamal公钥体制*, 困难性基于*椭圆曲线上的离散对数问题*

### ECC 密钥交换

ECDH (Elliptic Curve Diffie-Hellman Protocol) 基于ECC实现的DH密钥交换体系.  

公开信道获取$[d_{B}]G$, 私钥$d_{A}$, 获得共享密钥 $[d_{B}\ d_{A}]G$

### ECC 数字签名

椭圆曲线签名算法 (ECDSA)

设私钥$d$, 公钥$P=[d]G$, 基点G

私钥签名:  
- 选择随机数r, 计算$[r]G$. 其中 $r\in [1,\ n-1]$, n为G的阶
- 令 $x,y=[r]G$, 若 $x=0\pmod n$, 则重选r
- $s=r^{-1}(hash(M)+dx)$. 其中, M代表消息. 若 $s=0\pmod n$, 则重选r
- 将消息M 和 签名$\{\ x, s\ \}$ 发送

公钥验签:
- 检查 $r,\ s\in [1,\ n-1]$
- 计算 $x',\ y' = s^{-1}([hash(M)]G+[x]P)$
- 验证 $x'\equiv x$

原理: $\frac{[hash(M)]G+[x]P}{s}=\frac{[hash(M)+xd]G}{s}=rG$

> 分析见[Elgamal协议](../Elgamal协议.md), 该方案和Elgamal签名协议基本一致

### 与RSA对比

160位ECC 安全性和 1024位RSA相当, 所以ECC计算量较小, 同时占用的存储空间和带宽较少.

ECC缺点是相对较新, 应用和部署不如RSA广泛, 某些环境中ECC兼容性可能不佳; 
另外ECC计算和实现相对RSA复杂, 其具体性能依赖于实现方法. 

而RSA作为最早的公钥加密算法之一, 被广泛使用和研究, 使用范围更广泛.
由于公钥加密算法更多用于密钥交换环节, 直接用于加密的比较少, 所以RSA比ECC消耗更多资源通常是可接受的.
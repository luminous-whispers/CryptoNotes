## 1 RSA加密

加密用于保密，**防止信息泄露**

![[Pasted image 20230420135629.png|600]]

## 2 RSA签名

签名用于认证，**防止信息被篡改**

![[Pasted image 20230420140708.png|600]]

**总结：公钥加密、私钥解密、私钥签名、公钥验签。**

注意：因为rsa在加解密的时候，有长度限制，应该采用分段式加解密.

> 教科书式RSA不安全, 攻击者容易篡改明文, 见[RSA篡改](RSA-攻击/RSA-篡改攻击.md), 需[随机数填充](OAEP填充.md)或带附录签名等处理.

### 带附录的签名方式

明密文长度太长, 为加快速度减少成本, 通常采用取[杂凑值](../../杂凑函数/杂凑函数综述.md)的方法.  
除此之外, 采用哈希值, 长度易控制, 并且有很好的抗碰撞性.

签名流程:
1. 计算原始明文的哈希值H
2. 用私钥对哈希值H进行加密, 生成数字签名
3. 发送者将数字签名附加到原始明文上, 发送

一般情况下, 带附录的签名长度更长. 对于RSA签名, 

## 3 先签名再加密

为了同时实现保密性和认证性，需要同时采用双重加解密：

$$A\longrightarrow E_{SK_{A}} \longrightarrow E_{PK_{B}}\longrightarrow D_{SK_{B}}\longrightarrow D_{PK_{A}} \longrightarrow B$$

其中$PK_{B}$用于保密, $PK_{A}$用于认证.  

### 顺序合理性

先签名再加密, 只有接收者可以验证.  
先加密再签名, 可以公开验证.

推荐使用先签名再加密, 主要有以下优点:  
- 防止中间人攻击, 同时防止接收方抵赖
- 保护签名者身份

#### 中间人攻击

不加密的签名方案是危险的.

- Alice 发送: 加密消息C + 对C签名$S_{A}$
- Miledy 截获A信息, 替换为用自身私钥的签名, 转发给B: 加密消息C + 签名$S_{M}$
- Bob 收到 C + $S_M$, 在证书中匹配可以验签的公钥, 因此误认为消息来源是Miledy

> 中间人攻击还可以通过[篡改消息](./RSA-攻击/RSA-篡改攻击)的方式进行.


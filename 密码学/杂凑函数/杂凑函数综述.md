
**单向散列函数** (one-way hash function) 是指对不同的输入值, 通过单向散列函数进行计算, 得到固定长度的输出值。

单向散列函数也被称为**消息摘要函数**（message digest function）, **哈希函数**或者**杂凑函数**.   
输入的消息也称为**原像** (pre-image). 输出的散列值也称为**消息摘要** (message digest) 或者**指纹**（fingerprint），相当于该消息的身份证。

单向散列函数有多种实现算法，常见的有：**MD5**、**SHA-1**、**SHA-2**和 **SHA-3**。

**hash函数计算速度比对称加密还要快**

## **2\. 特性**

通过上面的定义，我们对单向散列函数的了解还是模糊的。下面介绍单向散列函数的特性，加深一下印象。

### **2.1 散列值长度固定**

无论消息的长度有多少，使用同一算法计算出的散列值长度总是固定的。比如 MD5 算法，无论输入多少，产生的散列值长度总是 128 比特（16字节）。

然而比特是计算机能够识别的单位，而我们人类更习惯于使用十六进制字符串来表示（一个字节占用两位十六进制字符）。

![](https://pic4.zhimg.com/v2-e9ea0496c9da1db1787718a87fdb3b9f_b.jpg)

### **2.2 消息不同其散列值也不同**

使用相同的消息，产生的散列值一定相同。

使用不同的消息，产生的散列值也不相同。哪怕只有一个比特的差别，得到的散列值也会有很大区别。

这一特性也叫做**抗碰撞性**，对于抗碰撞性弱的算法，我们不应该使用。

![](https://pic2.zhimg.com/v2-8e2a11e500be61e34239d317110cf5ad_b.jpg)

### **2.3 具备单向性**

只能通过消息计算出散列值，无法通过散列值反算出消息。

![](https://pic1.zhimg.com/v2-a93cfce62cc0eb3e224970febfcb0e7c_b.jpg)

### **2.4 计算速度快**

计算散列值的速度快。尽管消息越长，计算散列值的时间也越长，但也会在短时间内完成。

## **3\. 常见算法**

MD5 与 SHA-1 算法已被攻破，不应该被用于新的用途；SHA-2 与 SHA-3 还是安全的，可以使用。

SHA-2包括：SHA-224、SHA-256、SHA-384、SHA-512、SHA-512/224、SHA-512/256。

SHA-3包括：SHA3-224、SHA3-256、SHA3-384、SHA3-512。

| 算法名称 | 散列值长度 | 是否安全 |
| --- | --- | --- |

## 应用场景

单向散列函数仅保证信息完整性

#### 1 用户密码保护

设置密码时, 服务器不记录密码本身, 只记录密码散列值. 则数据库没有泄露风险.

为了预防彩虹表 (Rainbow Table), 通常向原始数据中[加盐 (salted hash)](消息认证码_MAC.md)

> 彩虹表攻击, 就是提前针对可能的输入计算输出值, 然后在输出值中查找*截获的用户hash值*.  
> 针对密钥等简短输入, 彩虹表需存储的表并不大, 计算资源消耗也不多, 因此效果较好.

#### 2 消息认证

> 详见 [消息认证码_MAC](消息认证码_MAC.md)

双方约定一**共享密钥**, 发送和验证*消息+共享密钥*的杂凑值.   
既可以验证消息是否被篡改, 也可以证明发送者身份.

#### 3 文件完整性校验

文件被挂载到网站和镜像源上时, 同时也附上其散列值和算法.  
用户下载后, 通过计算散列值并比对, 可以验证下载文件的完整性

#### 4 云盘快速上传

云盘上传大型文件时, 会先在数据库中寻找该其杂凑值是否已经存在. 若存在, 则说明其他用户已经将该文件上传过云盘, 只需要将该已存在文件和用户进行关联即可, 就不必重新上传. 这极大节省了云存储商的成本.


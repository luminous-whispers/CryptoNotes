e基于离散对数困难问题, 可以用于加密和签名.   

由于使用了随机数, 所以又称随机化加密. 使同一明文使用同一公钥加密产生的密文不同, 有效防御选择明文攻击和重放攻击等.

## 密钥生成

1. 选取大素数q, 使求解离散对数问题在$\mathbb{Z}_{q}$上困难
2. 选取 $\mathbb{Z}_{q}^*$ 上的本原元 $\alpha$
3. 选随机整数 $X_{A}\in \left[1, q-2\right)$, 计算 $Y_{A}=\alpha^{X_{A}}\pmod q$

则 Alice 的**公钥**为 $\{q, \alpha, Y_{A}\}$, **私钥**为 $\{X_A\}$

## 加密
Bob 向 Alice发送消息 $M\in\left[1, q-1\right]$ :

1. 选取**一次性**随机数$k\in \mathbb{Z_{q-1}}$
2. 计算一次性密钥 $K=(Y_{A})^{k}\pmod q$
3. $C_{1}=a^{k}\pmod q$
4. $C_{2}=KM\pmod q$

Bob 向 Alice 发送密文对 $\left(C_{1}, C_{2}\right)$

> 注意, 同一次加密中, 对于每组加密不能使用相同随机数k.  
> 否则其他组明文泄露后, 会使所有使用同一k的密文皆不安全.

## 解密

Alice 恢复 $M=C_{2}(C_{1}^{X_{A}})^{-1}\pmod q$

### 解密推导

$K\equiv(Y_{A})^{k}\pmod q\equiv (a^{X_{A}})^k\pmod q$

使用 $C_1$ 恢复出 $K$:
$C_{1}^{X_{A}}=(a^{k})^{X_{A}}\pmod q$

使用$K$和$C_{2}$恢复出$M$: 
$C_{2}\equiv KM\pmod q\equiv (a^{X_{A}})^{k}M\pmod q$

## 安全性分析

公开信道上有: $C_{1}$, $C_{2}$, $\{q, \alpha, Y_{A}\}$  
安全性由如下困难性保证:  

1. 知道 $C_{1}=\alpha^{k}$ 和 $\alpha$, 无法解出 $k$
2. 知道 $Y_{A}=\alpha^{X_{A}}$ 和 $\alpha$, 无法解出 $X_{A}$

$k$和$X_{A}$任一泄露, 明文都会泄露. 所以两者都是密钥.  
不加随机值$k$的DH体制无法实现加密功能, 因为只需求$Y_{A}^{-1}$即可解出$M$

***
# 问题
***离散对数问题的陷门信息是什么？？*** 因为没有所以才导致了构造密码体制这么别扭吧，必须两者同时参与
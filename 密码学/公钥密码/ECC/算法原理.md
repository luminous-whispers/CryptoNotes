> 相关数学知识见 [椭圆曲线](../../../几何/椭圆曲线.md)

## 椭圆曲线加密

设私钥、公钥分别为d、Q，即Q = dG，其中G为基点，椭圆曲线上的已知G和dG，求d是非常困难的，也就是说已知公钥和基点，想要算出私钥是非常困难的。  
**公钥加密：**选择随机数r，将消息M生成密文C，该密文是一个点对，C = {rG, M+rQ}，其中Q为公钥。  
**私钥解密**：M + rQ - d(rG) = M + r(dG) - d(rG) = M，其中d、Q分别为私钥、公钥。

> 基点是椭圆曲线上选择的一个点，这个点能够保证满足nG=∞的最小正整数n足够大（也就是阶足够大）（1<私钥<n，大于n的私钥a必能在[1,n)中找到对应的私钥b使得aG=bG，换句话说也就是有足够多的私钥）

### 详细解释

ECC是建立在基于**椭圆曲线的离散对数问题**上的密码体制，
单陷门函数为: K=\[k\]G, 给定K和G, 难以求出k

1、用户A选定一条椭圆曲线Ep(a,b)，并取椭圆曲线上一点，作为基点G。  
2、用户A选择一个私有密钥k，并生成公开密钥K=kG。  
3、用户A将Ep(a,b)和点K，G传给用户B。  
4、用户B接到信息后 ，将待传输的明文编码到Ep(a,b)上一点M（编码方法很多，这里不作讨论），并产生一个随机整数r。  
5、用户B计算点C1=M+rK；C2=rG。  
6、用户B将C1、C2传给用户A。  
7、用户A接到信息后，计算C1-kC2，结果就是点M。因为 C1-kC2=M+rK-k(rG)=M+rK-r(kG)=M，再对点M进行解码就可以得到明文。

在这个加密通信中，如果有一个偷窥者H ，他只能看到Ep(a,b)、K、G、C1、C2，而通过K、G 求k 或通过C2、G求r 都是相对困难的，因此，H无法得到A、B间传送的明文信息。

## 椭圆曲线签名

椭圆曲线签名算法(ECDSA)。设私钥、公钥分别为d、Q，即Q = dG，其中G为基点。

私钥签名：

-   选择随机数r，计算点rG(x, y)。
-   根据随机数r、消息M的哈希h、私钥d，计算s = (h + dx)/r。　　
-   将消息M、和签名{rG, s}发给接收方。

公钥验证签名：　　

-   接收方收到消息M、以及签名{rG=(x,y), s}。　　
-   根据消息求哈希h。　　
-   使用发送方公钥Q计算：hG/s + xQ/s，并与rG比较，如相等即验签成功。  
    原理：hG/s + xQ/s = hG/s + x(dG)/s = (h+xd)G/s = r(h+xd)G / (h+dx) = rG

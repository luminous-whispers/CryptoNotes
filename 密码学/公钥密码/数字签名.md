数字签名功能:
1. 确认信息由签名者发送, 不可否认.
2. 确认信息未被修改过.

## 数字签名改进
### 1 加盐 (添加冗余)
### 2 使用Hash函数
带附录的哈希函数签名

## 基于有限域离散对数问题
### 1 [ElGamal数字签名](Elgamal协议.md)
 #重点
### 2 Schnorr数字签名
 #重点  
Schenorr也是基于离散对数困难问题设计的, 其首先提出了 $g^{k}\pmod p$可以预计算. **为什么Schenorr数字签名更快?**

#### 2.1 密钥生成
1. 选素数 $p, q$, 使得 $q$是 $p-1$的素因子
2. 选择整数 $g$, 使得 $g^{q}=1\pmod p$. 
3. 选择随机数 $x$, 计算 $y=g^{-x}\pmod p$

公钥为 $\{y,\ g,\ p,\ q\}$, 私钥为 $\{x\}$

#### 2.2 签名

1. 选随机数 $k$, 计算 $r=g^{k}\pmod p$
2. $e=Hash(m\ \Vert\ r)$, m为待加密消息
3. $s=k+xe\pmod q$

签名为 $(e,\ s)$

#### 2.3 验签

1. 计算 $r'=g^{s}y^{e}\pmod p$
2. 验证 $Hash(m\ \Vert\ r')\equiv e$

其中 $r'\equiv g^{s}y^{e}\equiv g^{k+xe-xe}\equiv g^{k}\pmod p$

### 3 DSA 数字签名算法

DSA数字签名算法, 用于美国国家标准技术研究所 (NIST) 提出的DSS (Digital Signature Standard) 数字签名标准. DSA算法是Elgamal签名的变种, 同样基于有限域上离散对数问题. 但它比ElGamal的效率更高, 签名更短. 

DSA安全性依赖于 $\mathbb{Z}_{p}$的q阶子群上的DLP问题. 这种*大群的小阶子群*的思想来源于Schnorr.

#### 3.1 签名

$r=[g^{k} \pmod p] \pmod q$  
$s=[k^{-1}(Hash(M)+xr)]\pmod q$

#### 3.2 验签

收到签名 $\{s, r\}$ 与原消息 $M$:

$w=s^{-1}\pmod q$  
$u_{1}=[Hash(M)*w]\pmod q$  
$u_{2}=r*w\pmod q$  
$v=[g^{u_{1}}*y^{u_{2}}\pmod p]\pmod q$

接下来验证 $v\equiv r$, 因为 $v=[g^{[Hash(M)+xr]*w}\pmod p]\pmod q$

### 4 [椭圆曲线数字签名 ECDSA](ECC/ECC综述.md)

#重点

基于椭圆曲线域上的离散对数困难问题 ECDLP

## [RSA数字签名](RSA/RSA签名和加密.md)

## [Rabin数字签名](Rabin协议.md)

***

## 概念

**纯吊书袋, 水货老师只会教和考这些, 打了又不舍得删.**

### 1 数字签名安全性

#### 1.1 攻击者的目标

若攻击者能以**不可忽略的概率**完成下列操作(难度递减), 则称为攻破了该签名方案:

1. 完全攻破 (total break), 可揭示签名者私钥
2. 普遍性/通用伪造 (universal forgery), 可伪造出对任意消息签名的高效签名算法
3. 选择消息伪造 (selective forgery), 可生成某特定消息的有效签名
4. 存在性伪造 (existential foegery), 可至少生成一个消息的有效签名, 但敌手对得到的消息和签名无任何控制作用.

#### 1.2 攻击者能力

攻击者能力, 指攻击者可获得信息:(逐强)
- 唯密钥攻击: 只知 $Pk$
- 已知签名攻击: 知 $Pk$, 还知部分 $<msg, sign>$ 对
	1. 已知消息攻击
	2. 一般选择消息攻击
	3. 定向的选择消息攻击: 针对某个特定签名者. **定义存疑**
	4. 适应性选择消息攻击